/**
 * @name backbone.app
 * @author makesites
 * Homepage: http://github.com/makesites/backbone-app
 * Version: 1.0.0 (Mon, 01 May 2023 01:46:44 GMT)
 * @license Apache License, Version 2.0
 */
!function(t){"function"==typeof define&&define.amd?define("backbone.app",["jquery","underscore","backbone"],t):"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=t:t(window.jQuery||window.Zepto||window.vQuery,window._,window.Backbone,window.APP)}(function(t,n,e){var r,a,i,o,s,u,h,c,d,p,l,f,g,m,v,y,_,w,b,x,M,R,k=this.window||{},O=k.APP||!1,P=(O||(r=n,a={require:!1,routePath:"app/controllers/",autoLookup:!0,pushState:!1},(O=function(){var e,t,n=arguments[0]||{},i=arguments[1]||function(){},o=(n.require=n.require||"function"==typeof define&&define.amd,n=A.extend(a,n),!1),s=k.location?k.location.pathname.split("/"):[""];if(""===s[0]&&s.shift(),n.require)return e=n.routePath+"default","string"==typeof n.require?o=n.require:n.autoLookup?(o=n.routePath,o+=r.isEmpty(s[0])?"default":s[0]):o=e,"undefined"!=typeof require?require([o],function(t){t&&i(t)},function(t){if((t.requireModules&&t.requireModules[0])!=o)throw t;require([e],function(t){i(t)})}):System.import(o).then(function(t){t.default&&i(t.default)}).catch(function(t){System.import(e).then(function(t){i(t.default)})}),O;for(t in s)if(""!==s[t]&&(o=s[t].charAt(0).toUpperCase()+s[t].slice(1),"function"==typeof O.Routers[o]))break;return new(o&&O.Routers[o]?O.Routers[o]:O.Routers.Default)(n)}).Models={},O.Routers={},O.Collections={},O.Views={},O.Layouts={},O.Templates={}),
/**
 * @name backbone.easing
 * A View that has an interface for easing.js tweens
 *
 * Version: 0.2.3 (Wed, 02 Dec 2015 05:22:46 GMT)
 * Source: http://github.com/makesites/backbone-easing
 *
 * @author makesites
 * Initiated by: Makis Tracend (@tracend)
 * Distributed through [Makesites.org](http://makesites.org)
 *
 * @cc_on Copyright Â© Makesites.org
 * @license Released under the [MIT license](http://makesites.org/licenses/MIT)
 */
g=function(e,s,t){var n,i=k.APP||!1,o=!1!==i,r=(o&&void 0!==i.View?i:t).View,a=(s.mixin({now:function(){return(new Date).getTime()}}),r.extend({el:"body",options:{targetEl:k,ease:"easeFrom",duration:2},_transitionData:{start:0,end:0,easing:!1,startPos:0,endPos:0,pos:0},initialize:function(t){return s.bindAll(this,"transitionStart","transition","transitionEnd"),this.options=s.extend({},this.options,t),this.tick=new Tick,this.targetEl||(this.targetEl="string"==typeof this.options.targetEl?e(this.options.targetEl)[0]:this.options.targetEl),r.prototype.initialize.call(this,t)},transitionData:function(t){var e,n=s.now(),n={start:n,end:n+1e3*this.options.duration,easing:easing[this.options.ease],startPos:e,endPos:void 0,pos:e};return this._transitionData=n},transitionPos:function(t){},transitionStart:function(t){this.transitionData(t),this.tick.add(this.transition)},transition:function(){var t,e,n,i=s.now(),o=this._transitionData;return i>o.end||o.pos&&o.pos!==this.transitionPos()?this.transitionEnd():(t=o.startPos,n=o.endPos,e=o.easing,i=(o.end-i)/(1e3*this.options.duration),n=Math.round(t+(n-t)*(1-e(i))),this.transitionPos(n),o.pos=n,void(this._transitionData=o))},transitionEnd:function(){this.tick.remove(this.transition)},tween:function(t){return easing[t]}}));function u(t){(t=t||{}).rate&&(this.options.rate=t.rate),this.rate(),this.loop()}return function(t,e){"function"==typeof define?define(t,e):"undefined"!=typeof module&&(module.exports=e()),this[t]=e()}("easing",function(){return{easeInQuad:function(t){return Math.pow(t,2)},easeOutQuad:function(t){return-(Math.pow(t-1,2)-1)},easeInOutQuad:function(t){return(t/=.5)<1?.5*Math.pow(t,2):-.5*((t-=2)*t-2)},easeInCubic:function(t){return Math.pow(t,3)},easeOutCubic:function(t){return Math.pow(t-1,3)+1},easeInOutCubic:function(t){return(t/=.5)<1?.5*Math.pow(t,3):.5*(Math.pow(t-2,3)+2)},easeInQuart:function(t){return Math.pow(t,4)},easeOutQuart:function(t){return-(Math.pow(t-1,4)-1)},easeInOutQuart:function(t){return(t/=.5)<1?.5*Math.pow(t,4):-.5*((t-=2)*Math.pow(t,3)-2)},easeInQuint:function(t){return Math.pow(t,5)},easeOutQuint:function(t){return Math.pow(t-1,5)+1},easeInOutQuint:function(t){return(t/=.5)<1?.5*Math.pow(t,5):.5*(Math.pow(t-2,5)+2)},easeInSine:function(t){return 1-Math.cos(t*(Math.PI/2))},easeOutSine:function(t){return Math.sin(t*(Math.PI/2))},easeInOutSine:function(t){return-.5*(Math.cos(Math.PI*t)-1)},easeInExpo:function(t){return 0===t?0:Math.pow(2,10*(t-1))},easeOutExpo:function(t){return 1===t?1:1-Math.pow(2,-10*t)},easeInOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*--t))},easeInCirc:function(t){return-(Math.sqrt(1-t*t)-1)},easeOutCirc:function(t){return Math.sqrt(1-Math.pow(t-1,2))},easeInOutCirc:function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},easeOutBounce:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInBack:function(t){return t*t*(2.70158*t-1.70158)},easeOutBack:function(t){return(t-=1)*t*(2.70158*t+1.70158)+1},easeInOutBack:function(t){var e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},elastic:function(t){return-1*Math.pow(4,-8*t)*Math.sin((6*t-1)*(2*Math.PI)/2)+1},swingFromTo:function(t){var e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},swingFrom:function(t){return t*t*(2.70158*t-1.70158)},swingTo:function(t){return--t*t*(2.70158*t+1.70158)+1},bounce:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},bouncePast:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?2-(7.5625*(t-=1.5/2.75)*t+.75):t<2.5/2.75?2-(7.5625*(t-=2.25/2.75)*t+.9375):2-(7.5625*(t-=2.625/2.75)*t+.984375)},easeFromTo:function(t){return(t/=.5)<1?.5*Math.pow(t,4):-.5*((t-=2)*Math.pow(t,3)-2)},easeFrom:function(t){return Math.pow(t,4)},easeTo:function(t){return Math.pow(t,.25)}}}),n=this.window,u.prototype={options:{rate:1e3/60},queue:[],rate:function(e){e=e||this.options.rate,n.requestAnimFrame=n.requestAnimFrame||n.requestAnimationFrame||n.webkitRequestAnimationFrame||n.mozRequestAnimationFrame||n.oRequestAnimationFrame||n.msRequestAnimationFrame||function(t){n.setTimeout(function(){t(+new Date)},e)}},loop:function(t){this.process(t),n.requestAnimFrame(this.loop.bind(this))},process:function(t){for(var e in this.queue){var n=this.queue[e];"function"!=typeof n.fn||0==t%n.interval||n.run+n.interval>t||(n.fn(),this.queue[e]&&(this.queue[e].run=t))}},add:function(t,e){"function"==typeof t&&(e=e||this.options.rate,this.queue.push({fn:t,interval:e,run:0}))},remove:function(t){var e,n=!1;for(e in this.queue){var i=this.queue[e];String(i.fn)===String(t)&&(n=!0,delete this.queue[e])}return n}},n.Tick=u,t.Easing=a,o&&(i.Easing=a),"object"==typeof k&&"object"==typeof k.document&&(k.Backbone=t,o)&&(k.APP=i),a},"function"==typeof define&&define.amd?define("backbone.easing",["jquery","underscore","backbone"],g):"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=g:g(t||jQuery||Zepto||vQuery,n,e),!function(o,t){"use strict";var s=t.History.prototype.loadUrl;t.History.prototype.loadUrl=function(t){var e,n=s.apply(this,arguments),i=this.fragment;return/^\//.test(i)||(i="/"+i),void 0!==o._gaq&&o._gaq.push(["_trackPageview",i]),void 0!==(e=o.GoogleAnalyticsObject&&"ga"!==o.GoogleAnalyticsObject?o.GoogleAnalyticsObject:o.ga)&&e("send","pageview",i),n}}(k,e),n),S=e,A=(S.Model.extend,S.Model.extend=S.Collection.extend=S.Router.extend=S.View.extend=function(n,t){function e(){this.constructor=i}var i,o=this;n&&P.each(n,function(t,e){"string"==typeof t||"boolean"==typeof t||!(e in o.prototype)||t instanceof Function||o.prototype[e]instanceof Function||t instanceof S.Model||o.prototype[e]instanceof S.Model||t instanceof S.Collection||o.prototype[e]instanceof S.Collection||(n[e]=P.extend({},o.prototype[e],t))}),i=n&&P.has(n,"constructor")?n.constructor:function(){return o.apply(this,arguments)},P.extend(i,o,t);return e.prototype=o.prototype,i.prototype=Object.create(new e),n&&(i.prototype=P.extend({},i.prototype,n)),i.__super__=o.prototype,i},S.extend=function(){var t=Array.prototype.slice.call(arguments,0);if(t.length){var e,n=t.shift();for(e in t){var i=t[e],o=n,i=i.prototype||i;"object"==typeof i&&(delete(i=P.extend({},i))._parent,n=(i._parent=o).extend(i))}return n}},{extend:function(){var t,e=Array.prototype.slice.call(arguments),n={};for(t in e){var i,o=e[t];for(i in o)o[i]&&o[i].constructor&&o[i].constructor===Object?(n[i]=n[i]||{},n[i]=arguments.callee(n[i],o[i])):n[i]=o[i]}return n}});return g=n,jQuery,g.templateSettings={interpolate:/\{\{(.+?)\}\}/g,variable:"."},"undefined"!=typeof Handlebars&&g.mixin({template:Handlebars.compile}),i=k,o=document,g=e,s=(s=t)||("$"in i?i.$:i.jQuery||i.Zepto||!1),g.ready=function(t){return"undefined"!=typeof PhoneGap&&void 0!==PhoneGap.init&&void 0!==PhoneGap.env&&PhoneGap.env.app?PhoneGap.init(t):s?s(o).ready(t):i.addEventListener?i.addEventListener("load",t,!1):i.attachEvent("onload",t)},document,u=(g=e).View,g.View=u.extend({states:{},initialize:function(t){return this.initStates(),u.prototype.initialize.call(this,t)},initStates:function(){for(var t in this.states){var e=this.states[t];this.bind(t,n.bind(this[e],this))}}}),h=n,(g=O).Model=e.Model.extend({options:{autofetch:!1,cache:!1},initialize:function(t,e){this.options=h.extend({},this.options,e=e||{}),h.isNull(t)||h.isEmpty(t)||this.set(t),this.options.cache&&(e=this.cache())&&this.set(e),this.options.autofetch&&!h.isUndefined(this.url)&&this.fetch()},add:function(t){var n=this,i={};h.each(t,function(t,e){h.isUndefined(n.get(e))&&(i[e]=t)}),this.set(i)},reset:function(){return this.clear().set(this.defaults)},cache:e.Model.prototype.cache||function(){return!1},isOnline:function(){return!!h.isUndefined(app)||app.state.online},getValue:function(t,e){return t&&t[e]?h.isFunction(t[e])?t[e]():t[e]:null},parse:function(t){var e=this;return setTimeout(function(){e.trigger("fetch")},200),this.options.cache&&this.cache(t),t},output:function(){return this.toJSON()}}),MongoModel=g.Model.extend({parse:function(t){return t._id&&(t.id=t._id,delete t._id),t}}),c=n,(g=O).Collection=e.Collection.extend({options:{_synced:!1,autofetch:!1,cache:!1},model:g.Model,initialize:function(t,e){this.options=c.extend({},this.options,e=e||{}),this.options.cache&&(e=this.cache())&&this.add(e),this.options.autofetch&&c.isEmpty(t)&&this.url&&this.fetch()},update:function(){},save:function(t,e){var n;c.extend(this.models,t),e.success&&(n=c.after(this.models.length,e.success),c.each(this.models,function(t){t.save(null,{success:n})}))},cache:e.Collection.prototype.cache||function(){return!1},parse:function(t){var e=this;return setTimeout(function(){e.trigger("fetch")},200),this.options.cache&&this.cache(t),t},output:function(){return this.toJSON()},isNew:function(){return!1===this.options._synced},isOnline:function(){return!!c.isUndefined(app)||app.state.online}}),MongoCollection=g.Collection.extend({parse:function(t){for(var e in t)t[e].id=t[e]._id,delete t[e]._id;return t}}),d=n,l=t,f=O,(g=(p=e).View.prototype.state||new p.Model).set({loaded:!1,scroll:!1,visible:!1}),f.View=p.View.extend({options:{data:!1,html:!1,template:!1,url:!1,bind:"add remove reset change",type:!1,parentEl:!1,autoRender:!0,inRender:!1,silentRender:!1,renderTarget:!1,saveOptions:!0},events:{"click a[rel='external']":"clickExternal"},states:{scroll:"_scroll"},state:g,initialize:function(t){var e=this,n=(this.options=d.extend({},this.options,t=t||{}),l(this.el).unbind(),d.bindAll(this,"render","clickExternal","postRender","onLoaded","_url","_inDOM","_toJSON","_onLoaded"),"function"==typeof this.url&&d.bindAll(this,"url"),this.options.saveOptions&&(this.options=d.extend(this.options,t)),this.data=this.data||this.model||this.collection||null,this.options.data=!d.isNull(this.data),this.on("loaded",this.onLoaded),this.on("loaded",this._onLoaded),this.options.attr?l(this.el).attr("data-view",this.options.attr):l(this.el).removeAttr("data-view"),this.options.html||null),i=this.options.template||void 0===f?this.options.template:f.Template||!1,o=(this.url&&!this.options.url&&(this.options.url=this.url),this._url(t));return this.url=this._url,i?(this.options.type||(this.options.type="default"),this.template="function"==typeof i?new i(n,{url:o}):i,e.options.autoRender&&this.template.bind("loaded",this.render)):o?l.get(o,function(t){e.template=d.template(t),e.options.autoRender&&e.render()}):(this.template=d.template(n),e.options.autoRender&&this.render()),this.options.data&&!d.isUndefined(this.data.on)&&this.data.on(this.options.bind,this.render),this._initRender()?this.render():this.trigger("loaded"),l(k).bind("resize",d.bind(this._resize,this)),p.View.prototype.initialize.call(this,t)},_url:function(t){t=(t=t||{}).url||this.options.url;return"function"==typeof t?t():t},preRender:function(){},render:function(){var t,e,n;this.template&&(this._preRender(),n=this._getTemplate(),t=this.toJSON(),t=n instanceof Function?n(t):n,n=this._findContainer(),this.el||(e=l(t),this.el=this.$el=e),this._inDOM(),this.options.append?(e=e||l(t),n.append(e)):this.options.prepend?(e=e||l(t),n.prepend(e)):n.html(t),this._postRender())},postRender:function(){},listen:function(t,e,n){var i,o="string"==typeof e?[e]:e;for(i in o)t.bind(o[i],n)},resize:function(t){},clickExternal:function(e){e.preventDefault();e=this.findLink(e.target);"undefined"!=typeof pageTracker&&(e=pageTracker._getLinkerUrl(e));try{k.plugins.childBrowser.showWebPage(e)}catch(t){k.open(e,"_blank")}return!1},clickTab:function(t){t.preventDefault();var e=this.findLink(t.target);l(this.el).find(e).show().siblings().hide(),l(t.target).parent("li").addClass("selected").siblings().removeClass("selected")},findLink:function(t){return("A"!=t.tagName?l(t).closest("a"):l(t)).attr("href")},remove:function(){l(k).unbind("resize",this._resize),p.View.prototype.remove.call(this)},unbind:function(t,e){return this.off(t,null,e)},toJSON:function(){var t=this._toJSON();return this.options.inRender?{data:t,options:this.options}:t},onLoaded:function(){},parent:function(t,e){t=t||"",e=e||{},this.__inherit=this.__inherit||[];var n=(this.__inherit[t]||this._parent||{}).prototype||Object.getPrototypeOf(this).constructor.__super__,i=n[t]||function(){delete this.__inherit[t]},e=e instanceof Array?e:[e];return this.__inherit[t]=n._parent||function(){},i.apply(this,e)},_initRender:function(){var t,e;return!(!this.options.autoRender||(t=this._getTemplate(),t=this.options.html||this.options.url&&t,e=this.options.data&&(d.isUndefined(this.data.toJSON)||!d.isUndefined(this.data.toJSON)&&!d.isEmpty(this.data.toJSON())),(!t||!e)&&(!t||this.options.data)&&(!e||this.options.url)))},_preRender:function(){this.preRender()},_postRender:function(){this.options.silentRender||l(this.el).show(),this.options.data&&(!this.options.data||d.isEmpty(this._toJSON()))||(l(this.el).removeClass("loading"),this.state.set("loaded",!0),this.trigger("loaded")),this.postRender()},_toJSON:function(){return this.options.data?this.data.toJSON?this.data.toJSON():this.data:{}},_getTemplate:function(){return this.options.type?this.template.get(this.options.type):this.template},_onLoaded:function(){this.setElement(this.el)},_findContainer:function(){var t=this.el;return this.options.renderTarget&&("string"==typeof this.options.renderTarget?(t=l(this.el).find(this.options.renderTarget).first()).length||(t=l(this.options.renderTarget).first()):"object"==typeof this.options.renderTarget&&(t=this.options.renderTarget)),t instanceof jQuery?t:l(t)},_inDOM:function(t){var e;return!!(t=t||this.$el)&&(e=this.options.parentEl||"body",!!l(this.options.parentEl).find(t).length||void(this.options.parentPrepend?l(e).prepend(t):l(e).append(t)))},_navigate:function(t){},_resize:function(){var t=this,e=arguments;clearTimeout(void 0),setTimeout(function(){t.resize.apply(t,Array.prototype.slice.call(e))},1e3)},_scroll:function(){},isVisible:function(){var t=jQuery(k).width(),e=jQuery(k).height(),n=jQuery(document).scrollTop(),i=jQuery(document).scrollLeft(),o=n,n=n+e,e=i,i=i+t,t=l(this.el).offset(),o=t.top>=o&&t.top<n&&t.left>=e&&t.left<i;return o&&!this.state.get("visible")?this.trigger("visible"):this.trigger("hidden"),this.state.set("visible",o),o}}),m=n,v=e,y=t,(_=O).Layout=v.View.extend({el:"body",options:{autosync:!1,autorender:!0,sync_events:"add remove change"},events:{"click a:not([rel='external'],[rel='alternate'])":"_clickLink"},views:new v.Model,initialize:function(t){var e;return this.options=m.extend({},this.options,t=t||{}),y(this.el).unbind(),m.bindAll(this,"set","get","render","update","_clickLink","_viewLoaded","_syncData"),this.on("update",this.update),(this.options.url||this.url)&&(e=this.options.url||this.url,this.options.type||(this.options.type="default"),this.template=new _.Template(null,{url:e}),this.options.autorender)&&this.template.bind("loaded",this.render),t.data&&(this.data=t.data),v.View.prototype.initialize.call(this,t)},preRender:function(){},render:function(){var t;this._preRender(),y(this.el).removeClass("loading"),this.template&&(t=(this.options.type?this.template.get(this.options.type):this.template)(this.options),y(this.el).html(t)),this._postRender()},postRender:function(){},update:function(t){if((t=t||!1)&&t.navigate)for(var e in this.views.attributes)this.views.attributes[e]._navigate(t)},set:function(t){for(var e in t)t[e].on("loaded",m.bind(this._viewLoaded,this)),t[e]._name=e,t[e].data&&(t[e].data._view=e,t[e].data.on(this.options.sync_events,m.bind(this._syncData,this)));return this.views.set(t)},get:function(t){return this.views.get(t)},remove:function(t){var e=this.get(t);if(!m.isUndefined(e))return e.remove(),this.views.unset(t)},findLink:function(t){var t="A"!=t.tagName?y(t).closest("a"):y(t),e=t.attr("href"),n=!!e&&("#"==e.substr(0,1)||"/#"==e.substr(0,2)&&"/"==k.location.pathname);return!(m.isEmpty(e)||n||t.attr("target"))&&e},_preRender:function(){app.state.touch&&y(this.el).addClass("touch"),this.preRender()},_postRender:function(){this.postRender()},_viewLoaded:function(){var e=0,n=0;m.each(this.views.attributes,function(t){t.state.loaded&&n++,e++}),e==n&&this._allViewsLoaded()},_allViewsLoaded:m.once(function(){this.render()}),_syncData:function(t,e,n){var i=!1,e=e||t||!1;if(e){t=e._view||!1;if(t&&this.model instanceof v.Model){var o=this.model.keys()||[];if(-1!=o.indexOf(t)){try{i=e.output()}catch(t){i=e.toJSON()}i&&((o={})[t]=i,this.model.set(o),this.options.autosync)&&this.model.save()}}}},_clickLink:function(t){var e=this.findLink(t.target);if(e&&y(this.el).addClass("loading"),app.state.standalone()&&e)return t.preventDefault(),k.location=e,!1}}),w=n,b=t,O.Template=e.Model.extend({initialize:function(t,e){w.bindAll(this,"fetch","parse");e=e||{};w.isEmpty(t)||(this.set("default",this.compile(t)),this.trigger("loaded")),e.url&&(this.url=e.url,this.fetch())},compile:function(t){return w.template(t)},fetch:function(){b.get(this.url,this.parse)},parse:function(t){var e,n=this;try{e=b(t).filter("script")}catch(t){e=[]}e.length?e.each(function(){var t=b(this);0<=t.attr("type").indexOf("template")&&n.set(t.attr("id"),n.compile(t.html()))}):this.set("default",n.compile(t)),this.trigger("loaded")}}),x=n,M=e,(R=O).Router=M.Router.extend({options:{api:!1,autostart:!0,location:!1,pushState:!1,p404:"/"},routes:{"":"index","_=_":"_fixFB","access_token=:token":"access_token",logout:"logout"},data:new M.Model,initialize:function(t){t=t||{},x.bindAll(this,"access_token","preRoute","_layoutUpdate","_bindRoutes","_callRoute","_setup","_ajaxPrefilter","_fixFB"),x.extend(this.options,t),this._setup(),this.options.autostart&&M.history.start({pushState:this.options.pushState})},state:{fullscreen:!1,online:navigator.onLine,browser:function(){return/chrome/.test(navigator.userAgent.toLowerCase())?"chrome":/firefox/.test(navigator.userAgent.toLowerCase())?"firefox":/safari/.test(navigator.userAgent.toLowerCase())?"safari":"Microsoft Internet Explorer"==navigator.appName?"ie":/android/.test(navigator.userAgent.toLowerCase())?"android":/(iPhone|iPod).*OS 5.*AppleWebKit.*Mobile.*Safari/.test(navigator.userAgent)?"ios":-1!==navigator.userAgent.indexOf("Opera Mini")?"opera-mini":"other"},mobile:navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i),ipad:null!==navigator.userAgent.match(/iPad/i),retina:k.retina||1<k.devicePixelRatio,touch:"ontouchstart"in document.documentElement,pushstate:function(){try{return k.history.pushState({pageTitle:document.title},document.title,k.location),!0}catch(t){return!1}},scroll:!0,ram:function(){return console.memory?Math.round(console.memory.usedJSHeapSize/console.memory.totalJSHeapSize*100):0},standalone:function(){return"standalone"in navigator&&navigator.standalone||"undefined"!=typeof PhoneGap&&!x.isUndefined(PhoneGap.env)&&PhoneGap.env.app||"undefined"!=typeof external&&"function"==typeof external.msIsSiteMode&&external.msIsSiteMode()},framed:top!==self},update:function(){(this.state instanceof M.Model?this.state.get("scroll"):this.state.scroll)?t("body").removeClass("no-scroll"):t("body").addClass("no-scroll")},index:function(){},logout:function(){this.session&&this.session.trigger("logout",{reload:!0}),this.navigate("/",!0)},preRoute:function(t,e){var n=this;return!this.session||void 0===this.session.state||this.session.state?e.apply(n,t):this.session.bind("loaded",x.once(function(){e.apply(n,t)}))},access_token:function(t){this.session?this.session.set({token:t}):k.access_token=t,this.navigate("/",!0)},_setup:function(){this.options.api&&this._ajaxPrefilter(this.options.api),this.bind("all",this._layoutUpdate),this.options.location&&this._geoLocation(),this._setupSession()},_setupSession:function(){var t=R.Session||M.Session||!1;t&&(this.session=new t({},this.options.session||{}))},_ajaxPrefilter:function(i){var o=this.session||!1;t.ajaxPrefilter(function(t,e,n){"json"==e.dataType&&(0!==t.url.search(/^http/)&&(t.url=i+t.url),t.xhrFields={withCredentials:!0},e=o&&(o._csrf||o.get("_csrf"))||!1)&&n.setRequestHeader("X-CSRF-Token",e)})},_fixFB:function(){this.navigate("/",!0)},_layoutUpdate:function(t){this.layout&&this.layout.trigger("update",{navigate:!0,path:t})},_bindRoutes:function(){if(this.routes){this.routes=x.result(this,"routes");for(var t,e=x.keys(this.routes);void 0!==(t=e.pop());){var n=this.routes[t];this.route(t,n,this._callRoute(this[n]))}}},_callRoute:function(t){return function(){this.preRoute.call(this,arguments,t)}},_geoLocation:function(){var e=this;navigator.geolocation.getCurrentPosition(function(t){e.state.location=t},function(){console.log("error",arguments)}),setTimeout(function(){e._geoLocation()},3e4)},_404:function(t){console.log("Unable to find path: "+t),this.navigate(this.options.p404)}}),R.Routers.Default=R.Router,O.extend=e.extend,"object"==typeof k&&"object"==typeof k.document&&(k.APP=O),O});